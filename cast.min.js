"use strict";var head=document.getElementsByTagName("head")[0],script=document.createElement("script");function handler(){$pdk.bind({id:"player",controls:"full",logLevel:"event"});var e=!1;$pdk.controller.addPlayerCard("samples","red","<div class='container'><div class='card-container'><h1 style='color: white; margin:auto;font-size:4vw'>Casting to <span id='deviceName'></span></h1><div class='controls'><div style='display:flex;margin-top:3px;margin:auto'><div id='customPlay' class='custom-icon'></div><div id='customPause' class='custom-icon'></div><div style='display:flex'><div id='customMute' class='custom-icon'></div><div id='customVolume' class='custom-icon'></div><input type='range' min='1' max='100' value='0' class='slider' orient='vertical' step='0.1' id='volumeSlider'></div></div><div class='slidecontainer'><input type='range' min='1' max='100' value='0' class='slider' step='0.1' id='myRange'></div><div id='customTime' style='color:white;margin:auto'><p style='margin-bottom:0px;margin-top:0px;font-size:2vw' id='customTimerText'>00:00:00/00:00:00</p></div><div style='margin:auto'><div style='margin-right:25px'><div id='customCast' class='custom-icon'></div></div></div></div>","player",null,function(e,t){var o={};return o.controller=t,o.element=e,o.show=function(e){this.vars=e,e.deviceName&&(this.element.querySelector("#deviceName").textContent=e.deviceName)},o.hide=function(){console.log("Stop casting!")},o}),$pdk.controller.addEventListener("OnMediaLoadStart",function(t){s.playingURL=t.data.URL,function(){var t=document.createElement("div");t.id="cast-container";var o=document.createElement("div");if(o.id="button-container",o.innerHTML='<google-cast-launcher id="castbutton"></google-cast-launcher>',t.appendChild(o),!e){var r,a;if(a=Array.prototype.slice.call(document.querySelectorAll(".tpPlayer .tpControls .tpRow .tpFullscreen")).pop()){for(r=a;!r.classList.contains("tpRow")&&!r.classList.contains("tpControls");)r=r.parentNode;r.classList.contains("tpRow")&&(r.insertBefore(t,a),e=!0)}else(r=Array.prototype.slice.call(document.querySelectorAll(".tpPlayer .tpControls .tpRow")).pop())&&(r.appendChild(t),e=!0);r&&(a=r.querySelectorAll(".tpFullscreen"))}}()}),$pdk.controller.addEventListener("OnMediaPlaying",function(e){s.playingTime=e.data.currentTimeAggregate}),$pdk.controller.addEventListener("OnReleaseRequested",function(e){s.releaseURL=e.data.releaseURL}),$(document).on("click touchstart","#customPlay",function(){cast.framework.CastContext.getInstance().getCurrentSession().getMediaSession()?($(this).hide(),$("#customPause").show(),s.remotePlayer.isPaused&&s.remotePlayerController.playOrPause()):s.castMediaToDevice()}),$(document).on("click touchstart","#customPause",function(){$(this).hide(),$("#customPlay").show(),s.remotePlayer.isPaused||s.remotePlayerController.playOrPause()}),$(document).on("click touchstart","#customMute",function(){"none"==$("#volumeSlider").css("display")?$("#volumeSlider").show():$("#volumeSlider").hide()}),$(document).on("click touchstart","#customVolume",function(){"none"==$("#volumeSlider").css("display")?$("#volumeSlider").show():$("#volumeSlider").hide()}),$(document).on("click touchstart","#customCast",function(){cast.framework.CastContext.getInstance().getCurrentSession().endSession(!0)});var t=0;function o(e,t){e.val(t);var o=(e.val()-e.attr("min"))/(e.attr("max")-e.attr("min"));e.css("background","-webkit-gradient(linear, left top, right top, color-stop(0, #04b1ff), color-stop("+o+", #04b1ff), color-stop("+o+", #ffffff))")}function r(e){var t=new Date(null);return t.setSeconds(e),t.toISOString().substr(11,8)}function a(){var e=cast.framework.CastContext.getInstance().getCurrentSession(),t=e.getMediaSession();if(t){var a=t.getEstimatedTime();s.currentCastingTime=a;var i=r(s.remotePlayer.duration),n=r(a);$("#customTimerText").text(n+"/"+i);var c=a/s.remotePlayer.duration*100;o($("#myRange"),c)}else clearInterval(s.playerTimer),s.playingTime=0,e.endSession(!0)}$("#myRange").on("mousedown touchstart",function(e){t=$(this).val()}),$("#myRange").on("mouseup touchend",function(){var e=$(this).val();if(e!==t){var r=cast.framework.CastContext.getInstance().getCurrentSession().getMediaSession();if(r){clearInterval(s.playerTimer);var i=(e-$(this).attr("min"))/($(this).attr("max")-$(this).attr("min")),n=new chrome.cast.media.SeekRequest;n.currentTime=s.remotePlayer.duration*i,r.seek(n,function(){s.playerTimer=setInterval(a,1e3),console.log("Seek completed!")},function(e){console.log(e)})}else o($("#myRange"),0)}}),$("#myRange").on("input propertychange",function(){var e=($(this).val()-$(this).attr("min"))/($(this).attr("max")-$(this).attr("min"));$(this).css("background","-webkit-gradient(linear, left top, right top, color-stop(0, #04b1ff), color-stop("+e+", #04b1ff), color-stop("+e+", #ffffff))")}),$("#volumeSlider").on("input propertychange",function(){var e=($(this).val()-$(this).attr("min"))/($(this).attr("max")-$(this).attr("min"));$(this).css("background","-webkit-gradient(linear, left top, right top, color-stop(0, #04b1ff), color-stop("+e+", #04b1ff), color-stop("+e+", #ffffff))"),0==e?($("#customVolume").hide(),$("#customMute").show()):($("#customMute").hide(),$("#customVolume").show()),s.remotePlayer.volumeLevel=e,s.remotePlayerController.setVolumeLevel()});var i=function(){this.remotePlayer=null,this.remotePlayerController=null,this.playingURL=null,this.playingTime=null,this.playerTimer=null,this.releaseURL=null,this.isNewMediaLoaded=!1,this.currentCastingTime=null};i.prototype.initializeCastPlayer=function(){var e={};e.receiverApplicationId=chrome.cast.media.DEFAULT_MEDIA_RECEIVER_APP_ID,e.autoJoinPolicy=chrome.cast.AutoJoinPolicy.ORIGIN_SCOPED,cast.framework.CastContext.getInstance().setOptions(e),this.remotePlayer=new cast.framework.RemotePlayer,this.remotePlayerController=new cast.framework.RemotePlayerController(this.remotePlayer),this.remotePlayerController.addEventListener(cast.framework.RemotePlayerEventType.IS_CONNECTED_CHANGED,this.switchPlayer.bind(this))},i.prototype.switchPlayer=function(){cast&&cast.framework&&this.remotePlayer.isConnected?this.setupRemotePlayer():this.setupLocalPlayer()},i.prototype.setupRemotePlayer=function(){this.castMediaToDevice()},i.prototype.setupLocalPlayer=function(){s.remotePlayer.savedPlayerState.mediaInfo?($pdk.controller.seekTo(1e3*s.currentCastingTime),$pdk.controller.pause(!1)):$pdk.controller.preview(s.releaseURL),$pdk.controller.hidePlayerCard("samples","red"),clearInterval(s.playerTimer)},i.prototype.castMediaToDevice=function(){var e=cast.framework.CastContext.getInstance().getCurrentSession();if(s.playingURL){var t=new chrome.cast.media.MediaInfo(s.playingURL);t.metadata=new chrome.cast.media.GenericMediaMetadata,t.metadata.metadataType=chrome.cast.media.MetadataType.GENERIC;var r=new chrome.cast.media.LoadRequest(t);e.loadMedia(r).then(function(){$pdk.controller.pause(!0),s.remotePlayer.volumeLevel=.5,s.remotePlayerController.setVolumeLevel(),$("#customPlay").hide(),$("#customPause").show(),$("#customMute").show(),$("#customVolume").hide(),$("#volumeSlider").hide(),o($("#volumeSlider"),1),$pdk.controller.showPlayerCard("samples","red",null,{deviceName:e.getCastDevice().friendlyName}),s.playerTimer=setInterval(a,1e3);var t=e.getMediaSession(),r=new chrome.cast.media.SeekRequest;r.currentTime=s.playingTime/1e3,t.seek(r,function(){console.log("Seek completed!")},function(e){console.log(e)})},function(e){console.log("Remote media load error: "+i.getErrorMessage(e))})}},i.getErrorMessage=function(e){switch(e.code){case chrome.cast.ErrorCode.API_NOT_INITIALIZED:return"The API is not initialized."+(e.description?" :"+e.description:"");case chrome.cast.ErrorCode.CANCEL:return"The operation was canceled by the user"+(e.description?" :"+e.description:"");case chrome.cast.ErrorCode.CHANNEL_ERROR:return"A channel to the receiver is not available."+(e.description?" :"+e.description:"");case chrome.cast.ErrorCode.EXTENSION_MISSING:return"The Cast extension is not available."+(e.description?" :"+e.description:"");case chrome.cast.ErrorCode.INVALID_PARAMETER:return"The parameters to the operation were not valid."+(e.description?" :"+e.description:"");case chrome.cast.ErrorCode.RECEIVER_UNAVAILABLE:return"No receiver was compatible with the session request."+(e.description?" :"+e.description:"");case chrome.cast.ErrorCode.SESSION_ERROR:return"A session could not be created, or a session was invalid."+(e.description?" :"+e.description:"");case chrome.cast.ErrorCode.TIMEOUT:return"The operation timed out."+(e.description?" :"+e.description:"")}};var s=new i;window.__onGCastApiAvailable=function(e){e&&s.initializeCastPlayer()};var n=document.createElement("script");n.setAttribute("type","text/javascript"),n.src="https://www.gstatic.com/cv/js/sender/v1/cast_sender.js?loadCastFramework=1",document.body.appendChild(n)}script.type="text/javascript",script.src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js",script.onreadystatechange=handler,script.onload=handler,head.appendChild(script);